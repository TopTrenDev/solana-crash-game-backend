{"version":3,"sources":["../../../src/api/healthCheck/healthCheckRouter.ts","../../../src/api-docs/openAPIResponseBuilders.ts","../../../src/common/models/serviceResponse.ts","../../../src/common/utils/httpHandlers.ts"],"sourcesContent":["import { OpenAPIRegistry } from '@asteasolutions/zod-to-openapi';\r\nimport express, { Request, Response, Router } from 'express';\r\nimport { StatusCodes } from 'http-status-codes';\r\nimport { z } from 'zod';\r\n\r\nimport { createApiResponse } from '@/api-docs/openAPIResponseBuilders';\r\nimport { ResponseStatus, ServiceResponse } from '@/common/models/serviceResponse';\r\nimport { handleServiceResponse } from '@/common/utils/httpHandlers';\r\n\r\nexport const healthCheckRegistry = new OpenAPIRegistry();\r\n\r\nexport const healthCheckRouter: Router = (() => {\r\n  const router = express.Router();\r\n\r\n  healthCheckRegistry.registerPath({\r\n    method: 'get',\r\n    path: '/health-check',\r\n    tags: ['Health Check'],\r\n    responses: createApiResponse(z.null(), 'Success'),\r\n  });\r\n\r\n  router.get('/', (_req: Request, res: Response) => {\r\n    const serviceResponse = new ServiceResponse(ResponseStatus.Success, 'Service is healthy', null, StatusCodes.OK);\r\n    handleServiceResponse(serviceResponse, res);\r\n  });\r\n\r\n  return router;\r\n})();\r\n","import { StatusCodes } from 'http-status-codes';\r\nimport { z } from 'zod';\r\n\r\nimport { ServiceResponseSchema } from '@/common/models/serviceResponse';\r\n\r\nexport function createApiResponse(schema: z.ZodTypeAny, description: string, statusCode = StatusCodes.OK) {\r\n  return {\r\n    [statusCode]: {\r\n      description,\r\n      content: {\r\n        'application/json': {\r\n          schema: ServiceResponseSchema(schema),\r\n        },\r\n      },\r\n    },\r\n  };\r\n}\r\n\r\n// Use if you want multiple responses for a single endpoint\r\n\r\n// import { ResponseConfig } from '@asteasolutions/zod-to-openapi';\r\n// import { ApiResponseConfig } from '@common/models/openAPIResponseConfig';\r\n// export type ApiResponseConfig = {\r\n//   schema: z.ZodTypeAny;\r\n//   description: string;\r\n//   statusCode: StatusCodes;\r\n// };\r\n// export function createApiResponses(configs: ApiResponseConfig[]) {\r\n//   const responses: { [key: string]: ResponseConfig } = {};\r\n//   configs.forEach(({ schema, description, statusCode }) => {\r\n//     responses[statusCode] = {\r\n//       description,\r\n//       content: {\r\n//         'application/json': {\r\n//           schema: ServiceResponseSchema(schema),\r\n//         },\r\n//       },\r\n//     };\r\n//   });\r\n//   return responses;\r\n// }\r\n","import { z } from 'zod';\r\n\r\nexport enum ResponseStatus {\r\n  Success,\r\n  Failed,\r\n}\r\n\r\nexport class ServiceResponse<T = null> {\r\n  success: boolean;\r\n  message: string;\r\n  responseObject: T;\r\n  statusCode: number;\r\n\r\n  constructor(status: ResponseStatus, message: string, responseObject: T, statusCode: number) {\r\n    this.success = status === ResponseStatus.Success;\r\n    this.message = message;\r\n    this.responseObject = responseObject;\r\n    this.statusCode = statusCode;\r\n  }\r\n}\r\n\r\nexport const ServiceResponseSchema = <T extends z.ZodTypeAny>(dataSchema: T) =>\r\n  z.object({\r\n    success: z.boolean(),\r\n    message: z.string(),\r\n    responseObject: dataSchema.optional(),\r\n    statusCode: z.number(),\r\n  });\r\n","import { NextFunction, Request, Response } from 'express';\r\nimport { StatusCodes } from 'http-status-codes';\r\nimport { ZodError, ZodSchema } from 'zod';\r\n\r\nimport { ResponseStatus, ServiceResponse } from '@/common/models/serviceResponse';\r\n\r\nexport const handleServiceResponse = (serviceResponse: ServiceResponse<any>, response: Response) => {\r\n  return response.status(serviceResponse.statusCode).send(serviceResponse);\r\n};\r\n\r\nexport const validateRequest = (schema: ZodSchema) => (req: Request, res: Response, next: NextFunction) => {\r\n  try {\r\n    schema.parse({ body: req.body, query: req.query, params: req.params });\r\n    next();\r\n  } catch (err) {\r\n    const errorMessage = `Invalid input: ${(err as ZodError).errors.map((e) => e.message).join(', ')}`;\r\n    const statusCode = StatusCodes.BAD_REQUEST;\r\n    res.status(statusCode).send(new ServiceResponse<null>(ResponseStatus.Failed, errorMessage, null, statusCode));\r\n  }\r\n};\r\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,4BAAgC;AAChC,qBAAmD;AACnD,IAAAA,4BAA4B;AAC5B,IAAAC,cAAkB;;;ACHlB,+BAA4B;;;ACA5B,iBAAkB;AAOX,IAAM,kBAAN,MAAgC;AAAA,EACrC;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EAEA,YAAY,QAAwB,SAAiB,gBAAmB,YAAoB;AAC1F,SAAK,UAAU,WAAW;AAC1B,SAAK,UAAU;AACf,SAAK,iBAAiB;AACtB,SAAK,aAAa;AAAA,EACpB;AACF;AAEO,IAAM,wBAAwB,CAAyB,eAC5D,aAAE,OAAO;AAAA,EACP,SAAS,aAAE,QAAQ;AAAA,EACnB,SAAS,aAAE,OAAO;AAAA,EAClB,gBAAgB,WAAW,SAAS;AAAA,EACpC,YAAY,aAAE,OAAO;AACvB,CAAC;;;ADtBI,SAAS,kBAAkB,QAAsB,aAAqB,aAAa,qCAAY,IAAI;AACxG,SAAO;AAAA,IACL,CAAC,UAAU,GAAG;AAAA,MACZ;AAAA,MACA,SAAS;AAAA,QACP,oBAAoB;AAAA,UAClB,QAAQ,sBAAsB,MAAM;AAAA,QACtC;AAAA,MACF;AAAA,IACF;AAAA,EACF;AACF;;;AEfA,IAAAC,4BAA4B;AAKrB,IAAM,wBAAwB,CAAC,iBAAuC,aAAuB;AAClG,SAAO,SAAS,OAAO,gBAAgB,UAAU,EAAE,KAAK,eAAe;AACzE;;;AHCO,IAAM,sBAAsB,IAAI,sCAAgB;AAEhD,IAAM,qBAA6B,MAAM;AAC9C,QAAM,SAAS,eAAAC,QAAQ,OAAO;AAE9B,sBAAoB,aAAa;AAAA,IAC/B,QAAQ;AAAA,IACR,MAAM;AAAA,IACN,MAAM,CAAC,cAAc;AAAA,IACrB,WAAW,kBAAkB,cAAE,KAAK,GAAG,SAAS;AAAA,EAClD,CAAC;AAED,SAAO,IAAI,KAAK,CAAC,MAAe,QAAkB;AAChD,UAAM,kBAAkB,IAAI,iCAAwC,sBAAsB,MAAM,sCAAY,EAAE;AAC9G,0BAAsB,iBAAiB,GAAG;AAAA,EAC5C,CAAC;AAED,SAAO;AACT,GAAG;","names":["import_http_status_codes","import_zod","import_http_status_codes","express"]}